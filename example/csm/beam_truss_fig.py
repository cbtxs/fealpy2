import numpy as np
import matplotlib.pyplot as plt

from fealpy.mesh import EdgeMesh

# 构造网格
node = np.array([
    [3005.57544, 1503.7854,  50.],
    [3005.57544, 3003.7854,  50.],
    [2818.07544, 3003.7854,  100.],
    [2818.07544, 1503.7854,  100.],
    [2443.07544, 1503.7854,  0.],
    [2818.07544, 1503.7854,  0.],
    [3193.07544, 1503.7854,  0.],
    [3193.07544, 3.78534746, 0.],
    [3005.57544, 3.78534746, 50.],
    [3193.07544, 3003.7854,  0.],
    [2818.07544, 3003.7854,  0.],
    [2443.07544, 3003.7854,  0.],
    [2630.57544, 1503.7854,  150.],
    [2630.57544, 3003.7854,  150.],
    [2443.07544, 3003.7854,  200.],
    [2443.07544, 1503.7854,  200.],
    [2068.07544, 1503.7854,  0.],
    [2068.07544, 1503.7854,  300.],
    [2068.07544, 3.78534746, 300.],
    [2443.07544, 3.78534746, 0.],
    [2443.07544, 3.78534746, 200.],
    [2630.57544, 3.78534746, 150.],
    [2818.07544, 3.78534746, 100.],
    [2818.07544, 3.78534746, 0.],
    [2068.07544, 3003.7854,  300.],
    [2255.57544, 3003.7854,  250.],
    [2255.57544, 1503.7854,  250.],
    [2255.57544, 3.78534746, 250.],
    [1693.07544, 1503.7854,  0.],
    [1880.57544, 3.78534746, 350.],
    [1880.57544, 1503.7854,  350.],
    [1693.07544, 1503.7854,  400.],
    [1693.07544, 3.78534746, 400.],
    [1505.57544, 3.78534746, 350.],
    [1505.57544, 1503.7854,  350.],
    [1318.07544, 1503.7854,  300.],
    [1318.07544, 3003.7854,  300.],
    [943.0755,   3003.7854,  0.],
    [1318.07544, 3003.7854,  0.],
    [1693.07544, 3003.7854,  0.],
    [2068.07544, 3003.7854,  0.],
    [2068.07544, 3.78534746, 0.],
    [1880.57544, 3003.7854,  350.],
    [1693.07544, 3003.7854,  400.],
    [1693.07544, 3.78534746, 0.],
    [1318.07544, 3.78534746, 300.],
    [1318.07544, 3.78534746, 0.],
    [943.0755,   3.78534746, 0.],
    [568.0755,   3.78534746, 100.],
    [755.5755,   3.78534746, 150.],
    [943.0755,   3.78534746, 200.],
    [193.0755,   3.78534746, 0.],
    [193.0755,   1503.7854,  0.],
    [943.0755,   1503.7854,  0.],
    [1130.57544, 1503.7854,  250.],
    [1130.57544, 3003.7854,  250.],
    [943.0755,   3003.7854,  200.],
    [943.0755,   1503.7854,  200.],
    [1505.57544, 3003.7854,  350.],
    [1318.07544, 1503.7854,  0.],
    [568.0755,   3003.7854,  100.],
    [755.5755,   3003.7854,  150.],
    [193.0755,   3003.7854,  0.],
    [380.5755,   1503.7854,  50.],
    [568.0755,   1503.7854,  100.],
    [755.5755,   1503.7854,  150.],
    [380.5755,   3.78534746, 50.],
    [1130.57544, 3.78534746, 250.],
    [380.5755,   3003.7854,  50.]], dtype=np.float64)

cell_0 = np.array([
    [1, 2],
    [3, 2],
    [4, 3],
    [5, 4],
    [5, 6],
    [6, 7],
    [8, 7],
    [9, 8],
    [9, 1],
    [4, 1],
    [2, 10],
    [3, 11],
    [12, 3],
    [12, 11],
    [11, 10],
    [7, 10],
    [1, 7],
    [13, 4],
    [13, 14],
    [15, 14],
    [16, 15],
    [16, 5],
    [17, 5],
    [18, 17],
    [19, 18],
    [20, 19],
    [21, 20],
    [21, 22],
    [22, 23],
    [23, 9],
    [5, 18],
    [4,  6],
    [24, 8],
    [23, 24],
    [20, 23],
    [20, 24],
    [14, 3],
    [12, 25],
    [15, 12],
    [23,  4],
    [22, 13],
    [26, 15],
    [27, 26],
    [28, 27],
    [19, 28],
    [21, 16],
    [28, 21],
    [29, 17],
    [18, 29],
    [18, 27],
    [27, 16],
    [16, 13],
    [30, 19],
    [30, 31],
    [32, 31],
    [33, 32],
    [34, 33],
    [34, 35],
    [36, 35],
    [36, 37],
    [38, 37],
    [38, 39],
    [39, 40],
    [40, 41],
    [41, 12],
    [42, 20],
    [19, 42],
    [31, 18],
    [31, 43],
    [44, 43],
    [40, 44],
    [37, 40],
    [37, 39],
    [43, 25],
    [25, 26],
    [18, 25],
    [29, 32],
    [36, 29],
    [19, 45],
    [33, 30],
    [45, 33],
    [46, 45],
    [46, 47],
    [48, 47],
    [49, 48],
    [49, 50],
    [50, 51],
    [51, 48],
    [52, 48],
    [52, 53],
    [53, 54],
    [54, 36],
    [55, 36],
    [55, 56],
    [57, 56],
    [58, 57],
    [58, 54],
    [35, 32],
    [35, 59],
    [37, 59],
    [46, 34],
    [46, 36],
    [36, 60],
    [56, 37],
    [61, 38],
    [61, 62],
    [62, 57],
    [57, 38],
    [63, 38],
    [53, 63],
    [53, 64],
    [64, 65],
    [65, 66],
    [66, 58],
    [58, 55],
    [25, 40],
    [25, 41],
    [45, 42],
    [32, 44],
    [60, 29],
    [47, 45],
    [49, 65],
    [67, 49],
    [67, 64],
    [50, 66],
    [51, 68],
    [51, 58],
    [48, 46],
    [52, 67],
    [54, 60],
    [65, 54],
    [68, 55],
    [59, 44],
    [65, 61],
    [66, 62],
    [63, 69],
    [64, 69],
    [68, 46],
    [69, 61]], dtype=np.int_)

c0 = np.ones_like(cell_0)
cell = cell_0 - c0

mesh = EdgeMesh(node, cell)

# 节点、单元集合
nset_beam2 = np.array([1,  2,  3,  4,  7,  8,  9, 10, 13, 14, 15, 16, 18, 19, 21, 22,
                       23, 25, 26, 27, 28, 30, 31, 32, 33, 34, 35, 36, 37, 43, 44, 46,
                       49, 50, 51, 52, 53, 55, 56, 57, 58, 59, 61, 62, 63, 64, 65, 66,
                       67, 68, 69], dtype=np.int_)
elset_beam2 = np.array([2,   8,  10,  11,  17,  18,  20,  28,  29,  30,  37,  42,  45,  47,  50,  51,
                        52,  53,  55,  57,  59,  68,  70,  74,  75,  80,  86,  87,  93,  95,  98, 100,
                        101, 104, 106, 107, 111, 112, 113, 114, 115, 123, 126, 129, 133, 136, 138, 139], dtype=np.int_)

nset_beam = np.array([5,  6,  7,  8, 10, 11, 12, 17, 20, 24, 29, 38, 39, 40, 41, 42,
                      45, 47, 48, 52, 53, 54, 60, 63])
elset_beam = np.array([5,   6,  14,  15,  23,  33,  36,  48,  62,  63,  64,  65,  66,  84,  89,  91,
                       109, 118, 120, 121, 130], dtype=np.int_)

nset_Set3 = np.array([1,  2,  3,  4,  7,  8,  9, 10, 13, 14, 15, 16, 18, 19, 21, 22,
                      23, 25, 26, 27, 28, 30, 31, 32, 33, 34, 35, 36, 37, 43, 44, 46,
                      49, 50, 51, 52, 53, 55, 56, 57, 58, 59, 61, 62, 63, 64, 65, 66,
                      67, 68, 69], dtype=np.int_)
elset_Set3 = np.array([1,   3,   7,   9,  16,  19,  21,  25,  40,  41,  43,  44,  46,  54,  56,  58,
                       60,  69,  76,  90,  94,  96,  99, 102, 110, 119, 122, 124, 125, 127, 132, 134,
                       135, 137], dtype=np.int_)

nset_Set4 = np.array([3,  4,  5,  6, 11, 12, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25,
                      29, 32, 33, 36, 37, 38, 39, 40, 41, 42, 44, 45, 46, 47, 48, 49,
                      51, 54, 57, 58, 60, 61, 65], dtype=np.int_)
elset_Set4 = np.array([4,  12,  13,  22,  24,  26,  27,  31,  32,  34,  35,  38,  39,  49,  61,  67,
                       71,  72,  73,  77,  78,  79,  81,  82,  83,  85,  88,  92,  97, 103, 105, 108,
                       116, 117, 128, 131], dtype=np.int_)

fig = plt.figure()
axes = fig.add_subplot(1, 1, 1, projection='3d')
mesh.add_plot(axes)
mesh.add_plot(axes, nodecolor='b', cellcolor='m')
plt.show()
